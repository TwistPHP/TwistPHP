/*!
 * This file is part of TwistPHP.
 *
 * TwistPHP is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * TwistPHP is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with TwistPHP.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @author     Shadow Technologies Ltd. <contact@shadow-technologies.co.uk>
 * @license    https://www.gnu.org/licenses/gpl.html LGPL License
 * @link       https://twistphp.com
 *
 * TwistPHP Debug
 * --------------
 * @version 0.9.0
 */
!function(t,e,r){var a=!1,n=[],s=function(){if(t.console&&t.console.log&&arguments.length)for(var e in arguments)t.console.log(arguments[e])},o=function(){if(t.console&&arguments.length)for(var e in arguments)t.console.info?t.console.info(arguments[e]):s("INFO: ",arguments[e])},i=function(){if(t.console&&arguments.length)for(var e in arguments)t.console.warn?t.console.warn(arguments[e]):s("WARNING: ",arguments[e])},u=function(){if(t.console&&arguments.length)for(var e in arguments)t.console.error?t.console.error(arguments[e]):s("ERROR: ",arguments[e])},l=function(t,r){var a=e.createElement("script"),n=e.getElementsByTagName("head")[0],s=!1;r="function"==typeof r?r:function(){},a.src=t,a.onload=a.onreadystatechange=function(){if(!(s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)){s=!0;try{r()}catch(t){console.error(t)}a.onload=a.onreadystatechange=null,n.removeChild(a)}},n.appendChild(a)},d=function(e){var a=e===!0?t.jQuery.noConflict(!0):t.jQuery,s=a("#twist-debug-blocks"),i=a("#twist-debug-details"),u=function(t){var e=0;for(var r in t)t.hasOwnProperty(r)&&e++;return e},l=function(t,e,n,s,o,i,u){if(n){var l=n||"",d="",c="";if("object"==typeof n&&(l="<pre>"+JSON.stringify(n,r,2)+"</pre>"),"object"==typeof s)for(var g in s){var f=g.charAt(0).toUpperCase()+g.slice(1).replace("_"," "),p="object"==typeof s[g]?"<pre>"+JSON.stringify(s[g],r,2)+"</pre>":s[g];c+="<dt>"+f+"</dt><dd>"+p+"</dd>"}o!==r?""!==o&&(d=i!==r&&""!==i?u!==r&&""!==u?o+", line "+i+", column "+u:o+", line "+i:o):d="JavaScript ["+(new Date).getTime()+"]";var m=a('<div class="twist-debug-box-'+e+'" data-title="'+d+'"/>').html(l);return""!==c&&m.append('<div class="twist-debug-more-details"><dl>'+c+'</dl></div><a href="#twist-debug-more-details" class="twist-debug-more-details">&ctdot;</a>'),a(t).append(m),!0}return!1};this.error=function(t,e,r,n){var s={type:typeof t,length:"object"==typeof t?u(t):t.length};if(l("#twist-debug-messages-list","red","<p>"+t+"</p>",s,e,r,n)){var o=a("#twist-debug-errors");o.attr("data-count",parseInt(o.attr("data-count"))+1)}},this.warn=function(t,e,r,n){var s={type:typeof t,length:"object"==typeof t?u(t):t.length};if(l("#twist-debug-messages-list","yellow","<p>"+t+"</p>",s,e,r,n)){var o=a("#twist-debug-warnings");o.attr("data-count",parseInt(o.attr("data-count"))+1)}},this.log=function(t,e,r,n){var s={type:typeof t,length:"object"==typeof t?u(t):t.length};if(l("#twist-debug-messages-list","blue","<p>"+t+"</p>",s,e,r,n)){var o=a("#twist-debug-dumps");o.attr("data-count",parseInt(o.attr("data-count"))+1)}},this.logAJAX=function(t,e,r){var n={type:r.type,URL:r.url,timeout:r.timeout,cache:r.cache,request_data:r.data};if(l("#twist-debug-ajax-list",t?"green":"red",e,n,r.type+" "+r.url)){var s=a("#twist-debug-ajax-count");s.attr("data-count",parseInt(s.attr("data-count"))+1)}},this.logFileUpload=function(t,e){var n=e.support&&e.support["thumb-128"]?e.support["thumb-128"]:e.uri_preview,s="<pre>"+JSON.stringify(e,r,2)+'</pre><div class="twist-debug-fileupload-preview"><img src="'+n+'"></div>';if(l("#twist-debug-fileupload-list","green",s,t,t.name)){var o=a("#twist-debug-fileupload-count");o.attr("data-count",parseInt(o.attr("data-count"))+1)}};for(var d in n){var c=n[d];logError(c.title,c.message,c.url,c.line,c.column,c.error)}return a('.twist-debug-box, [class^="twist-debug-box-"], [class*=" twist-debug-box-"]').has(".twist-debug-more-details").each(function(){var t=a(this).find(".twist-debug-more-details");t.after('<a href="#twist-debug-more-details" class="twist-debug-more-details">&ctdot;</a>')}),s.on("click","a",function(t){t.preventDefault();var e=a(this);if(e.hasClass("current"))i.removeClass("show"),e.removeClass("current");else{var r=e.attr("href");i.addClass("show").children("div").hide().filter(r).show(),s.find("a.current").removeClass("current"),e.addClass("current")}}),a("#close-twist-debug-details").on("click",function(t){t.preventDefault(),s.find("a.current").removeClass("current"),i.removeClass("show")}),i.on("click",'a[href="#twist-debug-more-details"]',function(t){t.preventDefault(),a(this).prev(".twist-debug-more-details").slideToggle()}),a("#twist-debug-details").find("table").wrap('<div class="table-wrapper"/>'),a("#twist-debug").addClass("ready"),o("TwistPHP Debug is now loaded with jQuery v."+a.fn.jquery),this};t.onerror=function(t,e,r,a,s){var o={message:"<strong>JS Error:</strong> "+t,url:e,line:r,column:a,error:s};return n.push(o),!0},"undefined"==typeof t.jQuery?(a="function"==typeof t.$,l("http"+("https:"===location.protocol?"s":"")+"://code.jquery.com/jquery-1.12.0.min.js",function(){"undefined"==typeof t.jQuery?u("This is embarrassing... jQuery couldn't be loaded"):a?(i("Another JS library controls $"),t.twistdebug=new d(!0)):t.twistdebug=new d(!1)})):t.twistdebug=new d(!1)}(window,document);